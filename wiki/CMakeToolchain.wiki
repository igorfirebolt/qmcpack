#summary How to prepare a Toolchain file

||[Welcome Home]||[CMakeExplained cmake howto]||

<wiki:toc max_depth="1" />

One can prepare  a toolchain file, which is especially useful  on large
clusters with changing environments. The toolchains in `topdir/config` are
used by the developers on the NSF and DOE sites. Use them as a starting
point and customize them for your system.

In your build directory
{{{
cp ../config/AbeMvapich2.cmake yourtoolchain.cmake
.... modify yourtoolchain.cmake ....
cmake -DCMAKE_TOOLCHAIN_FILE=yourtoolchain.cmake ..
cmake -DCMAKE_TOOLCHAIN_FILE=yourtoolchain.cmake ..
make
}}}

= What is in a toolchain file  =
== Compilers and compiler options ==
Related cmake variables
|| `CMAKE_CXX_COMPILER`|| c++ compiler, linker ||
|| `CMAKE_C_COMPILER`|| c compiler ||
|| `CMAKE_CXX_FLAGS`|| flags for c++ ||
|| `CMAKE_C_FLAGS`|| flags for c ||

An example using GNU compilers:
{{{
set(CMAKE_CXX_COMPILER g++)
set(CMAKE_C_COMPILER  gcc)
set(CMAKE_CXX_FLAGS "-g -O3 -ftemplate-depth-60 -Drestrict=__restrict__ -funroll-all-loops   -finline-limit=1000 -Wno-deprecated ")
set(CMAKE_C_FLAGS "-O3 -Drestrict=__restrict__ -funroll-all-loops   -finline-limit=1000 -std=gnu99 -fomit-frame-pointer ")
}}}

== Paths for external libraries ==
Add the paths to `CMAKE_FIND_ROOT_PATH`
{{{
set(CMAKE_FIND_ROOT_PATH
    XYZ_HOME
    ....
)
}}}

This enables `CMake/FindXYZ.cmake` to search 
 * `XYZ_HOME/include` for the header files
 * `XYZ_HOME/lib` for the library files
Some libraries will link more than one library file.

== Set build properties ==
Important cmake variables are
|| *Variables* || *type* || *valid option* ||
|| `ENABLE_OPENMP`  || bool || 1/0 ||
|| `HAVE_MPI` || bool || 1/0 ||

= Special notes for cross-compilers =

= Clusters using GNU compilers =
 * [JaguarGNU JaguarGNU.cmake]
 * KrakenGNU.cmake 

= Clusters using INTEL compilers =
 * [AbeMvapich2 AbeMvapich2.cmake]
